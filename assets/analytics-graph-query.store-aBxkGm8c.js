var d=Object.defineProperty;var u=(t,e,r)=>e in t?d(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var o=(t,e,r)=>u(t,typeof e!="symbol"?e+"":e,r);import{cz as y,cB as h,cH as p,cI as n,cJ as l,b2 as c}from"./index-BCN26Ft_.js";import{c as m}from"./create-reaction-CzXnGxB7.js";class q{constructor(e){o(this,"query$",new h(null));o(this,"disposers",[]);o(this,"createQuery",this.query$.createAsyncAction(async e=>{const{data:r,error:s}=await p({query:{project_id:this.project.id,addresses:e.addresses.join(","),only_between:e.isBetweenSelectedOnly}});if(s)throw s;return a(r)},{onError:()=>{this.query$.clear()},errorToast:e=>({title:"Error",description:e.response.data.error})}));o(this,"refetchQuery",this.query$.createAsyncAction(async()=>{const{data:e,error:r}=await n({path:{id:this.query$.value.id}});if(r)throw r;return a(e)}));o(this,"loadQuery",this.query$.createAsyncAction(async e=>{const{data:r,error:s}=await n({path:{id:e}});if(s)throw s;return this.refetchQuery.cancelAllPendingCalls(),a(r)}));this.project=e,y(this);const r=m(()=>e,(s,i)=>{i&&this.clear()});this.disposers.push(r)}destroy(){this.disposers.forEach(e=>e==null?void 0:e()),this.disposers=[]}clear(){this.query$.clear()}}function a(t){const e={id:t.id,type:"graph",addresses:t.query.addresses.map(r=>l.parse(r)),creationDate:new Date(t.date_create),isBetweenSelectedOnly:t.query.only_between};return t.status==="success"?{...e,status:"success",resultUrl:`https://cosmograph.app/run/?nodeColor=color-node_color&nodeSize=size-node_value&data=${encodeURIComponent(t.url)}&meta=${encodeURIComponent(t.meta_url)}`,spentTimeMS:t.spent_time,cost:new c(t.cost)}:t.status==="executing"?{...e,status:"executing"}:{...e,status:"error",errorReason:t.error,spentTimeMS:t.spent_time,cost:new c(t.cost)}}export{q as A,a as m};
