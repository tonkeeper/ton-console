import{W as h,an as f,c1 as p}from"./index-BCN26Ft_.js";function y(t){if(!t.result.length)return null;const r=e=>({time:Number(e[0])*1e3,value:Math.round(Number(e[1])*100)/100});return t.result[0].values.map(e=>r(e))}function q({result:t},{result:r}){var u,o,i,c;if(!((u=t[0])!=null&&u.values.length)||!((o=r[0])!=null&&o.values.length))return null;const e=(i=t[0])==null?void 0:i.values.map(s=>{const[a,l]=s,d=Number(a)*1e3,m=Math.round(Number(l)*100)/100;return{time:d,value:m}}).sort((s,a)=>s.time-a.time),n=(c=r[0])==null?void 0:c.values.map(s=>{const[a,l]=s,d=Number(a)*1e3,m=Math.round(Number(l)*100)/100;return{time:d,value:m}}).sort((s,a)=>s.time-a.time);return{requests:e,connections:n}}function w(){const t=h();return f({queryKey:["rest-stats",t||void 0],queryFn:async()=>{if(!t)return null;const r=Math.round(Date.now()/1e3-3600*24*7),e=Math.floor(Date.now()/1e3),n=60*30,{data:u,error:o}=await p({query:{project_id:t,start:r,step:n,end:e,detailed:!1}});if(o)throw o;return y(u.stats)},enabled:!!t,staleTime:30*1e3})}function S(){const t=h();return f({queryKey:["liteproxy-stats",t||void 0],queryFn:async()=>{if(!t)return null;const r=Math.round(Date.now()/1e3-3600*6),e=Math.floor(Date.now()/1e3),n=60,u=p({query:{project_id:t,start:r,step:n,end:e,detailed:!1,dashboard:"liteproxy_requests"}}),o=p({query:{project_id:t,start:r,step:n,end:e,detailed:!1,dashboard:"liteproxy_connections"}}),[i,c]=await Promise.all([u,o]);if(i.error||c.error)throw new Error("Failed to fetch liteproxy stats");const s=i.data.stats,a=c.data.stats;return q(s,a)},enabled:!!t,staleTime:30*1e3})}export{S as a,w as u};
