import{aj as ye,j as e,B as d,F as p,C as z,ak as je,al as me,r as m,am as fe,W as P,an as E,Z as U,ao as L,ap as v,aq as ae,ar as be,as as ge,at as we,au as Ce,av as Se,T as l,L as H,aw as Z,ae as ke,ax as ve,ay as Pe,az as Te,o as x,b as y,aA as $,aB as X,aC as F,aD as _,aE as q,aF as B,aG as O,l as A,_ as oe,$ as ie,aH as Me,N as Ae,aI as Ie,aJ as Re,V as De,R as Ee,U as Ue,aK as Le,aL as Fe,aM as K,aN as _e,d as qe,D as G,aO as Be,aP as Oe,aQ as Ne,aR as Ve,aS as We,aT as Qe,aU as Y,aV as ce,aW as le,m as Ke,aX as ze,k as J,G as de,aY as He,O as ee,p as Q,S as D}from"./index-BCN26Ft_.js";import{D as Ge}from"./DeleteIcon24-Bd3bueMl.js";import{U as $e}from"./usd-currency-amount-OKdR9Ymz.js";import{C as Xe}from"./CardLink-CXh3WTVz.js";import{T as Ye,a as Je,b as se,c as Ze,d as ne}from"./tab-panels-BFaL-foB.js";import{U as re,a as I}from"./list-D2sr8y6t.js";import{C as R}from"./code-DjpzS3La.js";import{R as et}from"./RefillModalContent-DlFbo1-1.js";import{V as tt}from"./v-stack-DE1rRJbv.js";const st=t=>{const{radioProps:s,rest:n}=nt(t),{getInputProps:r,getRadioProps:a}=ye(s),i=r(),o=a();return e.jsxs(d,{as:"label",...n,children:[e.jsx("input",{...i}),e.jsxs(p,{...o,gap:"2",py:"3",pr:"5",pl:"3",border:"1px",borderColor:"separator.common",borderRadius:"md",_checked:{bg:"background.contentTint"},cursor:"pointer",transition:"background 0.1s linear",children:[e.jsx(z,{w:"6",h:"6",children:e.jsx(z,{w:"18px",h:"18px",bg:"transparent",border:"1px",borderColor:"icon.secondary",borderRadius:"100%",boxSizing:"border-box",children:e.jsx(d,{as:je,w:"18px",h:"18px",in:!!(s!=null&&s.isChecked),children:e.jsx(me,{display:"block"})})})}),t.children]})]})};function nt(t){if(!t)return{radioProps:void 0};const{id:s,name:n,value:r,isChecked:a,defaultChecked:i,isDisabled:o,isFocusable:c,isReadOnly:u,isInvalid:j,isRequired:g,onChange:w,"data-radiogroup":h,"aria-describedby":M,...f}=t;return{radioProps:{id:s,name:n,value:r,isChecked:a,defaultChecked:i,isDisabled:o,isFocusable:c,isReadOnly:u,isInvalid:j,isRequired:g,onChange:w,"data-radiogroup":h,"aria-describedby":M},rest:f}}function rt(t,s,n,r){const[i,o]=m.useState("idle"),[c,u]=m.useState(void 0),{clearErrors:j,setError:g,formState:w,getFieldState:h,watch:M}=t,{error:f}=h(s,w),C=M(s);return m.useEffect(()=>{let T=!1;return o("idle"),u(void 0),(async()=>{if(!f&&C){if(j(s),await new Promise(W=>setTimeout(W,500)),T)return;o("validating");const S=await n(C);if(!T){if(!S){o("succeed");return}S&&"success"in S&&S.success?(u(S.result),o("succeed")):(g(s,S),o("idle"))}}})(),()=>{T=!0}},[f,C,j,g,n]),[i,c]}const ue=async t=>{const s=new TextEncoder().encode(t),r=`https://c.tonapi.io/json?url=${btoa(String.fromCharCode(...s))}`,a=await fe.get(r),i=a.data.url;if(!i||typeof i!="string")throw new Error("Cannot parse response");let o;"name"in a.data&&a.data.name&&typeof a.data.name=="string"&&(o=a.data.name);let c;return"iconUrl"in a.data&&a.data.iconUrl&&typeof a.data.iconUrl=="string"&&(c=a.data.iconUrl),{url:i,...o&&{name:o},...c&&{image:c}}},at=async t=>{try{return{success:!0,result:await ue(t)}}catch{return{message:"Cannot fetch manifest"}}},N={all:()=>["dapps"],byProject:t=>[...N.all(),"project",t]};function ot(t){return t.verify}function it(t){const s={id:t.id,url:t.url,creationDate:new Date(t.date_create)};return t.name&&(s.name=t.name),t.image&&(s.image=t.image),s}async function ct(t){const{data:s,error:n}=await Ce({query:{project_id:t}});if(n)throw n;return s.items.filter(ot).map(it)}function V(){const t=P();return E({queryKey:N.byProject(t),queryFn:async()=>t?ct(t):[],enabled:!!t,staleTime:5*60*1e3})}function lt(){const t=U(),s=P();return L({mutationFn:async n=>{const r=s;if(!r)throw new Error("Project not selected");let a=n;if(!n.name||!n.image)try{const c=await ue(ae(n.url,"tonconnect-manifest.json"));a={...n,name:c.name,image:c.image}}catch{}const{data:i,error:o}=await be({query:{project_id:r},body:a});if(o)throw o;return{...a,token:i.payload,validUntil:new Date(i.valid_until*1e3),_projectId:r}},onSuccess:n=>{t.invalidateQueries({queryKey:N.byProject(n._projectId)}),v().toast({title:"App created successfully",description:"Please verify it to complete registration",status:"success",duration:5e3,isClosable:!0})},onError:n=>{v().toast({title:"Failed to create app",description:n instanceof Error?n.message:"Unknown error",status:"error",duration:5e3,isClosable:!0})}})}function dt(){const t=U(),s=P();return L({mutationFn:async n=>{const r=s;if(!r)throw new Error("Project not selected");const{error:a}=await ge({query:{project_id:r},body:{payload:n}});if(a)throw a;return{_projectId:r}},onSuccess:n=>{t.invalidateQueries({queryKey:N.byProject(n._projectId)}),v().toast({title:"Dapp validated successfully",status:"success",duration:5e3,isClosable:!0})},onError:()=>{v().toast({title:"Dapp validation error",description:"Make sure you put the file to your webserver",status:"error",duration:5e3,isClosable:!0})}})}function ut(){const t=U(),s=P();return L({mutationFn:async n=>{const r=s;if(!r)throw new Error("Project not selected");const{error:a}=await we({query:{app_id:n}});if(a)throw a;return{_projectId:r}},onSuccess:n=>{t.invalidateQueries({queryKey:N.byProject(n._projectId)}),v().toast({title:"Dapp deleted successfully",status:"success",duration:5e3,isClosable:!0})},onError:()=>{v().toast({title:"Dapp wasn't deleted",status:"error",duration:5e3,isClosable:!0})}})}const xt={manifest:"TonConnect Manifest URL"},pt=({onSubmit:t,validator:s,submitButtonLoading:n,...r})=>{const a=Se({mode:"onChange"}),{handleSubmit:i,register:o,getFieldState:c,formState:{errors:u,isDirty:j,isValid:g}}=a,[w,h]=rt(a,"manifest",s),M=w!=="succeed",{isTouched:f}=c("manifest"),{isTouched:C}=c("url"),T=m.useRef(f),b=m.useRef(C);m.useEffect(()=>{f&&(T.current=!0)},[f]),m.useEffect(()=>{C&&(b.current=!0)},[C]);const S=m.useCallback(W=>{if(W.url)return t({url:W.url});if(h)return t(h);throw new Error("App url form error: appUrl is not specified as well as manifestUrl")},[h,t]);return e.jsxs(d,{...r,children:[e.jsx(l,{textStyle:"label1",mb:"6",color:"text.primary",children:"Registration"}),e.jsxs(p,{align:"center",justify:"space-between",children:[e.jsx(l,{textStyle:"label2",mr:"2",color:"text.primary",children:xt.manifest}),e.jsx(H,{textStyle:"label2",color:"text.accent",href:Z.APP_URL_DOCUMENTATION,isExternal:!0,children:"Documentation"})]}),e.jsxs(ke.form,{noValidate:!0,onSubmit:i(S),children:[e.jsxs(ve,{mb:"5",isInvalid:!!u.manifest,children:[e.jsx(Pe,{autoComplete:"off",placeholder:"https://yourapp.com/tonconnect-manifest.json",validationState:w,...o("manifest",{required:"Required",pattern:{value:/^https?:\/\/.+/,message:"Wrong URL format"}})}),e.jsx(Te,{children:u.manifest&&u.manifest.message})]}),!!(h!=null&&h.url)&&e.jsxs(l,{textStyle:"body2",mb:"4",color:"text.secondary",children:["App url",e.jsx(x,{textStyle:"body2",fontFamily:"mono",color:"text.primary",ml:"4",children:h==null?void 0:h.url})]}),e.jsx(y,{isDisabled:!j||!g||M,isLoading:n,type:"submit",children:"Register"})]})]})},ht=({appUrl:t,...s})=>e.jsxs($,{scrollBehavior:"inside",size:"md",...s,children:[e.jsx(X,{}),e.jsxs(F,{children:[e.jsx(_,{textAlign:"center",children:"Are you sure you want to reset the form?"}),e.jsx(q,{}),e.jsx(B,{pb:"0",children:e.jsxs(l,{textStyle:"text.body2",mb:"6",color:"text.secondary",textAlign:"center",children:["Reset ",t,"?"]})}),e.jsxs(O,{gap:"3",children:[e.jsx(y,{flex:1,onClick:()=>s.onClose(),variant:"secondary",children:"Cancel"}),e.jsx(y,{flex:1,onClick:()=>s.onClose(!0),type:"submit",variant:"primary",children:"Reset"})]})]})]}),yt=({appUrl:t,...s})=>e.jsxs($,{scrollBehavior:"inside",size:"md",...s,children:[e.jsx(X,{}),e.jsxs(F,{children:[e.jsx(_,{textAlign:"center",children:"Remove your app?"}),e.jsx(q,{}),e.jsx(B,{pb:"0",children:e.jsx(l,{textStyle:"text.body2",mb:"6",color:"text.secondary",textAlign:"center",children:t})}),e.jsxs(O,{gap:"3",children:[e.jsx(y,{flex:1,onClick:()=>s.onClose(),variant:"secondary",children:"Cancel"}),e.jsx(y,{flex:1,onClick:()=>s.onClose(!0),type:"submit",variant:"primary",children:"Remove"})]})]})]}),xe=({dapp:t,withMenu:s,...n})=>{const{isOpen:r,onOpen:a,onClose:i}=A(),o=ut(),c=u=>{i(),u&&t.id!==void 0&&typeof t.id=="number"&&o.mutate(t.id)};return e.jsxs(e.Fragment,{children:[e.jsx(oe,{w:"fit-content",maxW:"100%",...n,children:e.jsxs(ie,{alignItems:"center",gap:"3",display:"flex",px:"4",py:"4",children:[e.jsx(Me,{borderRadius:"sm",w:"12",h:"12",minW:"12",src:t.image}),e.jsxs(d,{children:[e.jsx(l,{textStyle:"label2",mb:"2",color:"text.primary",fontFamily:"mono",wordBreak:"break-word",noOfLines:1,children:t.url}),e.jsx(l,{textStyle:"label2",color:"text.secondary",wordBreak:"break-word",noOfLines:1,children:t.name})]}),s&&e.jsxs(Ae,{placement:"bottom-end",children:[e.jsx(Ie,{as:Re,alignSelf:"flex-start",h:"4","aria-label":"options",icon:e.jsx(De,{})}),e.jsx(Ee,{w:"132px",children:e.jsxs(Ue,{onClick:a,children:[e.jsx(Ge,{mr:"2"}),e.jsx(l,{textStyle:"label2",fontFamily:"body",children:"Remove"})]})})]})]})}),e.jsx(yt,{appUrl:t.url,isOpen:r,onClose:c})]})},jt=({pendingDapp:t,onReset:s,...n})=>{const{isOpen:r,onOpen:a,onClose:i}=A(),o=c=>{i(),c&&s()};return e.jsxs(d,{...n,children:[e.jsx(l,{textStyle:"label1",mb:"3",color:"text.primary",children:"Your app"}),e.jsx(xe,{maxW:"600px",mb:"4",dapp:t}),e.jsx(y,{onClick:a,variant:"secondary",children:"Remove"}),e.jsx(ht,{appUrl:t.url,isOpen:r,onClose:o})]})},mt=({pendingDapp:t,onSubmit:s,submitLoading:n,...r})=>{const a="tc-verify.json",i=ae(t.url,"tc-verify.json"),{onCopy:o,hasCopied:c}=Le(a);return e.jsxs(d,{...r,children:[e.jsx(l,{textStyle:"label1",mb:"3",color:"text.primary",children:"Verification"}),e.jsxs(l,{textStyle:"body2",mb:"2",color:"text.secondary",children:["We need you to verify ownership of domain ",t.url,". Please follow the steps below to prove the ownership."]}),e.jsxs(l,{textStyle:"body2",mb:"2",color:"text.secondary",children:["Create a JSON file"," ",e.jsx(Fe,{isOpen:c,label:"Copied",children:e.jsx(x,{cursor:"pointer",onClick:o,fontFamily:"mono",children:a})})," ","copy and paste content below:"]}),e.jsx(l,{textStyle:"label1",mb:"3",color:"text.primary",children:"Payload Key"}),e.jsx(K,{whiteSpace:"pre-wrap",mb:"2",iconAlign:"start",text:`{
    "payload": "`+t.token+`"
}`}),e.jsxs(l,{textStyle:"body2",mb:"2",color:"text.secondary",children:["Make sure the file is available at"," ",e.jsx(H,{textStyle:"label2",href:i,isExternal:!0,children:i})]}),e.jsxs(H,{textStyle:"label2",alignItems:"center",gap:"2",display:"flex",mb:"4",href:Z.VALIDATION_DOCUMENTATION,isExternal:!0,children:[e.jsx(_e,{}),e.jsx(x,{children:"See step-by-step guide"})]}),e.jsxs(p,{gap:"3",children:[e.jsx(y,{isLoading:n,onClick:s,children:"Verify"}),e.jsx(qe,{variant:"secondary",isExternal:!0,href:Z.GET_HELP,children:"Help"})]})]})},ft=()=>{const[t,s]=m.useState(null),n=lt(),r=dt(),a=async c=>{try{const u=await n.mutateAsync(c);s(u)}catch{}},i=async()=>{if(t)try{await r.mutateAsync(t.token),s(null)}catch{}},o=()=>{s(null)};return t?e.jsxs(e.Fragment,{children:[e.jsx(jt,{maxW:"800px",px:"6",mb:"5",pendingDapp:t,onReset:o}),e.jsx(G,{mb:"4"}),e.jsx(mt,{maxW:"850px",px:"6",pendingDapp:t,onSubmit:i,submitLoading:r.isPending})]}):e.jsx(pt,{maxW:"800px",px:"6",onSubmit:a,submitButtonLoading:n.isPending,validator:at})},bt=t=>{const{data:s}=V(),n=s==null?void 0:s[0];return n?e.jsx(xe,{...t,dapp:n}):null};var te=(t=>(t.BUSINESS_DESCRIPTION="https://docs.tonconsole.com/tonconsole/tonkeeper-messages",t.USAGE="https://docs.tonconsole.com/tonconsole/tonkeeper-messages",t))(te||{});const k={all:()=>["messages"],packages:()=>[...k.all(),"packages"],balance:t=>[...k.all(),"balance",t],stats:t=>[...k.all(),"stats",t],token:t=>[...k.all(),"token",t]};function gt(t){return{messagesIncluded:t.limits,price:new $e(t.usd_price),name:t.name,id:t.id}}function wt(){return E({queryKey:k.packages(),queryFn:async()=>{const{data:t,error:s}=await Ne();if(s)throw s;return t.items.map(gt)},staleTime:10*60*1e3})}function pe(){const t=P();return E({queryKey:k.balance(t),queryFn:async()=>{if(!t)return 0;const{data:s,error:n}=await Ve({query:{project_id:t}});if(n)throw n;return s.balance},enabled:!!t,staleTime:1*60*1e3})}function Ct(t){const s=P();return E({queryKey:k.stats(t),queryFn:async()=>{if(!t||!s)return null;const{data:n,error:r}=await We({query:{app_id:t}});if(r)throw r;return{totalUsers:n.stats.users,usersWithEnabledNotifications:n.stats.enable_notifications,sentNotificationsLastWeek:n.stats.sent_in_week}},enabled:!!t&&!!s,staleTime:5*60*1e3})}function St(t){const s=P();return E({queryKey:k.token(t),queryFn:async()=>{if(!t||!s)return null;const{data:n,error:r}=await Qe({query:{app_id:t}});if(r)throw r;return n.token},enabled:!!t&&!!s,staleTime:5*60*1e3})}function kt(){const t=U(),s=P();return L({mutationFn:async n=>{const r=s;if(!r)throw new Error("Project not selected");const{error:a}=await Oe({query:{project_id:r},body:{id:n}});if(a)throw a;return{_projectId:r}},onSuccess:n=>{t.invalidateQueries({queryKey:k.balance(n._projectId)}),v().toast({title:"Successful purchase",status:"success",duration:5e3,isClosable:!0})},onError:()=>{v().toast({title:"Unsuccessful purchase",status:"error",duration:5e3,isClosable:!0})}})}function he(){const t=U(),s=P();return L({mutationFn:async n=>{const r=s;if(!r)throw new Error("Project not selected");const{error:a}=await Be({query:{app_id:n}});if(a)throw a;return{_appId:n,_projectId:r}},onSuccess:n=>{t.invalidateQueries({queryKey:k.token(n._appId)}),v().toast({title:"Token regenerated successfully",status:"success",duration:5e3,isClosable:!0})},onError:()=>{v().toast({title:"Token regeneration error",status:"error",duration:5e3,isClosable:!0})}})}const vt=({onClose:t,pkg:s})=>{const n=kt(),r=()=>{n.mutate(s.id,{onSuccess:t})};return e.jsxs(F,{children:[e.jsx(_,{children:"Details"}),e.jsx(q,{}),e.jsx(B,{pt:"0",pb:"2",children:e.jsx(oe,{children:e.jsxs(ie,{textStyle:"body2",px:"6",py:"5",children:[e.jsxs(p,{justify:"space-between",mb:"3",children:[e.jsx(x,{color:"text.secondary",children:"Package"}),e.jsx(x,{children:s.name})]}),e.jsxs(p,{justify:"space-between",mb:"3",children:[e.jsx(x,{color:"text.secondary",children:"Includes"}),e.jsxs(x,{children:[Y(s.messagesIncluded)," messages"]})]}),e.jsxs(p,{justify:"space-between",mb:"3",children:[e.jsx(x,{color:"text.secondary",children:"Type"}),e.jsx(x,{children:"One-time payment"})]}),e.jsxs(p,{justify:"space-between",children:[e.jsx(x,{color:"text.secondary",children:"Price"}),e.jsx(x,{children:s.price.stringCurrencyAmount})]}),e.jsx(p,{justify:"flex-end",children:e.jsx(ce,{color:"text.secondary",textStyle:"body2",currency:le.TON,amount:s.price.amount,reverse:!0,children:" TON"})})]})})}),e.jsxs(O,{gap:"3",pt:"4",children:[e.jsx(y,{flex:1,onClick:t,variant:"secondary",children:"Cancel"}),e.jsx(y,{flex:1,isLoading:n.isPending,onClick:r,variant:"primary",children:"Purchase"})]})]})},Pt=({isOpen:t,onClose:s})=>{var f,C,T;const{data:n=[]}=wt(),[r,a]=m.useState(null),{data:i}=Ke(),{getRootProps:o,getRadioProps:c}=ze({name:"package",defaultValue:((f=n[0])==null?void 0:f.name)||"",onChange:b=>a(n.find(S=>S.name===b)||null)}),u=o(),j=i&&r&&BigInt(((C=i.ton)==null?void 0:C.amount)||0)<BigInt(r.price.amount.toNumber())?BigInt(r.price.amount.toNumber())-BigInt(((T=i.ton)==null?void 0:T.amount)||0):0;m.useEffect(()=>{a(n[0])},[n]);const g=A(),w=A();m.useEffect(()=>{t||(g.onClose(),w.onClose())},[t]);const h=()=>{j?g.onOpen():w.onOpen()},M=e.jsxs(F,{children:[e.jsxs(_,{children:[e.jsx(J,{mb:"1",children:"Pricing"}),e.jsx(l,{textStyle:"body2",color:"text.secondary",children:"It’s one-time payment"})]}),e.jsx(q,{}),e.jsxs(B,{pt:"0",pb:"2",children:[n.length>0?e.jsx(tt,{...u,children:n.map(b=>e.jsx(st,{w:"100%",...c({value:b.name}),children:e.jsxs(d,{w:"100%",children:[e.jsxs(p,{justify:"space-between",children:[e.jsx(l,{textStyle:"label1",children:b.name}),e.jsx(l,{textStyle:"label1",textAlign:"end",children:b.price.stringCurrencyAmount})]}),e.jsxs(p,{justify:"space-between",w:"100%",children:[e.jsxs(l,{textStyle:"body2",color:"text.secondary",children:[Y(b.messagesIncluded)," messages"]}),e.jsx(ce,{textStyle:"body2",color:"text.secondary",leftSign:"",textAlign:"end",currency:le.TON,amount:b.price.amount,reverse:!0,contentUnderSkeleton:" TON"})]})]})},b.id))}):e.jsx(z,{h:"200px",children:e.jsx(de,{})}),!!j&&e.jsxs(l,{textStyle:"body2",mt:"3",color:"text.secondary",children:[e.jsx(He,{})," Not enough $",j.toString()," to buy the plan, fund your account"]})]}),e.jsxs(O,{gap:"3",pt:"4",children:[e.jsx(y,{flex:1,onClick:s,variant:"secondary",children:"Cancel"}),e.jsx(y,{flex:1,onClick:h,variant:"primary",children:j?"Refill balance":"Choose"})]})]});return e.jsxs($,{isOpen:t,onClose:s,scrollBehavior:"inside",size:"md",children:[e.jsx(X,{}),g.isOpen?e.jsx(et,{onClose:s}):w.isOpen?e.jsx(vt,{onClose:s,pkg:r}):M]})},Tt=({isOpen:t,onClose:s})=>{var o;const{data:n}=V(),r=(o=n==null?void 0:n[0])==null?void 0:o.id,a=he(),i=()=>{r&&a.mutate(r,{onSuccess:s})};return e.jsxs($,{isOpen:t,onClose:s,scrollBehavior:"inside",size:"md",children:[e.jsx(X,{}),e.jsxs(F,{children:[e.jsx(_,{children:"Generate new token?"}),e.jsx(q,{}),e.jsx(B,{pt:"0",pb:"2",children:"If you generate new the token, the previous token will no longer work"}),e.jsxs(O,{gap:"3",pt:"4",children:[e.jsx(y,{flex:1,onClick:s,variant:"secondary",children:"Cancel"}),e.jsx(y,{flex:1,isLoading:a.isPending,onClick:i,variant:"primary",children:"Confirm"})]})]})]})},Mt=()=>e.jsxs(ee,{px:"0",children:[e.jsxs(d,{maxW:"800px",px:"6",children:[e.jsx(J,{mb:"1",children:"Tonkeeper Messages"}),e.jsxs(l,{textStyle:"body2",mb:"5",color:"text.secondary",children:["Interact with users of your dapp through push messages inside Tonkeeper — an effective way to increase customer engagement and retention. ",e.jsx(H,{color:"accent.blue",href:te.BUSINESS_DESCRIPTION,isExternal:!0,children:"Learn more"})]})]}),e.jsx(G,{mb:"3"}),e.jsx(ft,{})]}),At=t=>{var u;const{data:s}=V(),n=(u=s==null?void 0:s[0])==null?void 0:u.id,{data:r,isLoading:a}=Ct(n??null),{data:i,isLoading:o}=pe(),c=a||o;return e.jsxs(d,{...t,children:[e.jsxs(p,{justify:"space-between",children:[e.jsxs(d,{mb:"2",children:[e.jsx(x,{textStyle:"body2",color:"text.secondary",children:"All users"})," ",e.jsx(Q,{children:"All dApp users with login by Tonkeeper and Ton Connect 2.0"})]}),e.jsx(x,{textStyle:"body2",textAlign:"end",children:!c&&r?r.totalUsers:e.jsx(D,{w:"100px",h:"3"})})]}),e.jsxs(p,{justify:"space-between",children:[e.jsxs(d,{mb:"2",children:[e.jsx(x,{textStyle:"body2",color:"text.secondary",children:"Enable notifications"})," ",e.jsx(Q,{children:"Users who have allowed push notifications from your dApp"})]}),e.jsx(x,{textStyle:"body2",textAlign:"end",children:!c&&r?r.usersWithEnabledNotifications:e.jsx(D,{w:"100px",h:"3"})})]}),e.jsxs(p,{justify:"space-between",children:[e.jsxs(d,{mb:"2",children:[e.jsx(x,{textStyle:"body2",color:"text.secondary",children:"Available messages"})," ",e.jsx(Q,{children:"Push messages balance that you can send to your users"})]}),e.jsx(x,{textStyle:"body2",textAlign:"end",children:!c&&i!==void 0?Y(i):e.jsx(D,{w:"100px",h:"3"})})]}),e.jsxs(p,{justify:"space-between",children:[e.jsxs(d,{mb:"2",children:[e.jsx(x,{textStyle:"body2",color:"text.secondary",children:"Sent last 7 days"})," ",e.jsx(Q,{children:"Messages with delivered to dApp users last 7 days"})]}),e.jsx(x,{textStyle:"body2",textAlign:"end",children:!c&&r?r.sentNotificationsLastWeek:e.jsx(D,{w:"100px",h:"3"})})]})]})},It=t=>{var j;const{isOpen:s,onOpen:n,onClose:r}=A(),{data:a}=V(),i=(j=a==null?void 0:a[0])==null?void 0:j.id,{data:o,isLoading:c}=St(i??null),u=he();return e.jsxs(d,{...t,children:[e.jsxs(d,{px:"6",children:[e.jsx(l,{textStyle:"body2",mb:"2",children:"Token"}),e.jsxs(p,{gap:"3",mb:"2",children:[e.jsx(K,{isLoading:c,flex:"1",wordBreak:"break-all",text:o||""}),e.jsx(y,{h:"auto",isDisabled:c,isLoading:u.isPending,onClick:n,variant:"secondary",children:"Generate"}),e.jsx(Tt,{isOpen:s,onClose:r})]}),e.jsxs(l,{textStyle:"body2",mb:"4",color:"text.secondary",children:["This token provides access to messages API, is should be used from backend side and never exposed into client side of the project.",e.jsx("br",{}),"To send push notification please add Authorization header with token to your push API request."]})]}),e.jsxs(Ye,{mb:"4",isLazy:!0,children:[e.jsxs(Je,{pl:"6",children:[e.jsx(se,{children:"Message User"}),e.jsx(se,{children:"Message All Users"})]}),e.jsxs(Ze,{px:"6",children:[e.jsxs(ne,{children:[e.jsx(l,{textStyle:"label2",mb:"3",children:"Posting a message for user by wallet address with Curl:"}),e.jsx(K,{isLoading:c,whiteSpace:"pre-wrap",text:`curl -X POST
    https://tonconsole.com/api/v1/services/messages/push
    -H 'Content-Type: application/json'
    -H 'Authorization: Bearer ${o||""}'
    -d
    '{"message": "my_message", "addresses": ["EQ...ER", "EQ...ER"], "link": "http://my_dapp.com/event"}'`,iconAlign:"start",mb:"3"}),e.jsxs(d,{textStyle:"body2",color:"text.secondary",children:[e.jsx(d,{mb:"1",children:"Where body have properties:"}),e.jsxs(re,{listStyleType:'"-"',spacing:"1",children:[e.jsxs(I,{pl:"1",children:[e.jsx(R,{children:"address"})," is user's wallet address"]}),e.jsxs(I,{pl:"1",children:[e.jsx(R,{children:"message"})," is call to action message for user"]}),e.jsxs(I,{pl:"1",children:[e.jsx(R,{children:"link"})," for user action, the link will be opened in Tonkeeper dApp Browser"]})]})]})]}),e.jsxs(ne,{children:[e.jsx(l,{textStyle:"label2",mb:"3",children:"Posting a message for all users with allow notifications with Curl:"}),e.jsx(K,{isLoading:c,whiteSpace:"pre-wrap",text:`curl -X POST
    https://tonconsole.com/api/v1/services/messages/push
    -H 'Content-Type: application/json'
    -H 'Authorization: Bearer ${o||""}'
    -d
    '{"message": "my_message", "link": "http://my_dapp.com/event"}'`,iconAlign:"start",mb:"3"}),e.jsxs(d,{textStyle:"body2",color:"text.secondary",children:[e.jsx(d,{mb:"1",children:"Where body have properties:"}),e.jsxs(re,{listStyleType:'"-"',spacing:"1",children:[e.jsxs(I,{pl:"1",children:[e.jsx(R,{children:"message"})," is call to action message for user"]}),e.jsxs(I,{pl:"1",children:[e.jsx(R,{children:"link"})," for user action, the link will be opened in Tonkeeper dApp Browser"]})]})]})]})]})]}),e.jsx(Xe,{href:te.USAGE,mb:"1",mx:"6"})]})},Rt=t=>{const{isOpen:s,onOpen:n,onClose:r}=A(),{data:a,isLoading:i}=pe(),o=!i&&a===0;return e.jsxs(ee,{h:"fit-content",w:"320px",...t,children:[e.jsx(J,{mb:"1",children:i?e.jsx(D,{w:"100px",h:"6"}):Y(a||0)}),e.jsx(l,{textStyle:"body2",mb:"5",color:"text.secondary",children:"Available messages"}),e.jsx(y,{w:"100%",onClick:n,variant:o?"primary":"secondary",children:"Refill"}),e.jsx(Pt,{isOpen:s,onClose:r})]})},Dt=()=>e.jsxs(p,{gap:"4",children:[e.jsxs(ee,{px:"0",children:[e.jsxs(d,{mb:"6",px:"6",children:[e.jsx(J,{mb:"5",children:"Tonkeeper Messages"}),e.jsx(bt,{withMenu:!0})]}),e.jsx(G,{}),e.jsxs(d,{mb:"6",px:"6",pt:"5",children:[e.jsx(l,{textStyle:"label1",mb:"5",children:"Statistics"}),e.jsx(At,{maxW:"256px"})]}),e.jsx(G,{}),e.jsxs(d,{pt:"5",children:[e.jsx(l,{textStyle:"label1",mb:"5",px:"6",children:"Authorization"}),e.jsx(It,{})]})]}),e.jsx(Rt,{flexShrink:"0"})]}),Vt=()=>{const{data:t,isLoading:s}=V();return s?e.jsx(z,{h:"200px",children:e.jsx(de,{})}):t&&t.length>0?e.jsx(Dt,{}):e.jsx(Mt,{})};export{Vt as default};
