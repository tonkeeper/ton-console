import{q as f,aT as h,cf as p}from"./index--6gyeIm1.js";import{a as y,b as q}from"./time-periods-B2gFC1G6.js";function S(e){if(!e.result.length)return null;const t=s=>({time:Number(s[0])*1e3,value:Math.round(Number(s[1])*100)/100});return e.result[0].values.map(s=>t(s))}function v({result:e},{result:t}){var n,i,o,c;if(!((n=e[0])!=null&&n.values.length)||!((i=t[0])!=null&&i.values.length))return null;const s=(o=e[0])==null?void 0:o.values.map(a=>{const[r,l]=a,m=Number(r)*1e3,d=Math.round(Number(l)*100)/100;return{time:m,value:d}}).sort((a,r)=>a.time-r.time),u=(c=t[0])==null?void 0:c.values.map(a=>{const[r,l]=a,m=Number(r)*1e3,d=Math.round(Number(l)*100)/100;return{time:m,value:d}}).sort((a,r)=>a.time-r.time);return{requests:s,connections:u}}function T(e="last_6h"){const t=f(),s=q(e),{start:u,end:n}=y(e);return h({queryKey:["rest-stats",t||void 0,e],queryFn:async()=>{if(!t)return null;const{data:i,error:o}=await p({query:{project_id:t,start:u,step:s.stepSeconds,end:n,detailed:!1}});if(o)throw o;return S(i.stats)},enabled:!!t,staleTime:30*1e3})}function P(e="last_6h"){const t=f(),s=q(e),{start:u,end:n}=y(e);return h({queryKey:["liteproxy-stats",t||void 0,e],queryFn:async()=>{if(!t)return null;const i=p({query:{project_id:t,start:u,step:s.stepSeconds,end:n,detailed:!1,dashboard:"liteproxy_requests"}}),o=p({query:{project_id:t,start:u,step:s.stepSeconds,end:n,detailed:!1,dashboard:"liteproxy_connections"}}),[c,a]=await Promise.all([i,o]);if(c.error||a.error)throw new Error("Failed to fetch liteproxy stats");const r=c.data.stats,l=a.data.stats;return v(r,l)},enabled:!!t,staleTime:30*1e3})}export{P as a,T as u};
