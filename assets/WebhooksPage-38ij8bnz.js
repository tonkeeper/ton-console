import{b3 as Y,r as h,j as e,ae as N,ax as Q,b7 as G,b9 as X,az as J,K as A,dg as T,av as Z,aA as L,aB as B,aC as _,aD as R,aE as z,aF as H,bj as ee,aG as te,b as k,bM as se,T as p,G as P,s as ne,v as oe,w as M,x as m,y as re,L as I,bm as ie,z as b,bf as O,B as C,dh as ae,F as x,a0 as E,aJ as le,bN as ce,N as U,Q as de,V as xe,R as K,U as W,bO as he,k as $,bp as je,di as ue,dj as me,E as V,a2 as be,dk as pe,a7 as fe,a8 as ye,a9 as ke,dl as ge,l as D,C as Ce,O as v,cQ as We,o as w,cl as Te,cK as g}from"./index-BCN26Ft_.js";import{u as Se,a as ve,b as q,c as we}from"./queries-C0jQ22JL.js";import{D as Ee}from"./DeleteIcon24-Bd3bueMl.js";import{c as Ie}from"./copy-to-clipboard-Ct1_m45i.js";import{T as Me}from"./table-container-B5le7CdA.js";import{C as Oe}from"./CreateIcon96-DLe490jy.js";const De=({id:n,onSubmit:a,disableDefaultFocus:o,...d})=>{const l=u=>{a({endpoint:u.endpoint})},{handleSubmit:r,register:s,setFocus:i,formState:{errors:c}}=Y();return h.useEffect(()=>{o||i("endpoint")},[o,i]),e.jsx(N.form,{id:n,w:"100%",onSubmit:r(l),noValidate:!0,...d,children:e.jsxs(Q,{isInvalid:!!c.endpoint,isRequired:!0,children:[e.jsx(G,{htmlFor:"name",children:"Webhook URL"}),e.jsx(X,{autoComplete:"off",id:"name",placeholder:"Your webhook URL",...s("endpoint",{required:"This is required",minLength:{value:3,message:"Minimum length should be 3"}})}),e.jsx(J,{children:c.endpoint&&c.endpoint.message})]})})},Fe=n=>{const a=A(),o="create-webhook-form",{network:d,setSelectedWebhookId:l}=T(),{mutate:r,isPending:s}=Se(d),i=Z(),{reset:c,formState:{isDirty:u}}=i,j=h.useCallback(y=>{r(y,{onSuccess:f=>{const t=f.webhook_id||f.id;if(!t)throw new Error("Webhook was not created");l(t),a(`./view?webhookId=${t}`)}})},[r,a,l]);return h.useEffect(()=>{n.isOpen||setTimeout(c,200)},[c,n.isOpen]),e.jsxs(L,{scrollBehavior:"inside",...n,children:[e.jsx(B,{}),e.jsxs(_,{children:[e.jsx(R,{children:"New Webhook"}),e.jsx(z,{}),e.jsx(H,{children:e.jsx(ee,{...i,children:e.jsx(De,{id:o,onSubmit:j})})}),e.jsxs(te,{gap:"3",children:[e.jsx(k,{flex:1,onClick:n.onClose,variant:"secondary",children:"Cancel"}),e.jsx(k,{flex:1,form:o,isDisabled:!u,isLoading:s,type:"submit",variant:"primary",children:"Create"})]})]})]})},Ne=({webhook:n,isOpen:a,onClose:o})=>{const{network:d}=T(),{mutate:l,isPending:r}=ve(d),s=h.useCallback(()=>{n&&l(n.id,{onSuccess:o})},[n,l,o]);return e.jsx(se,{isOpen:a,onClose:o,onConfirm:s,title:i=>`Delete ${i}`,description:i=>e.jsx(e.Fragment,{children:e.jsxs(p,{textStyle:"text.body2",mb:"6",color:"text.secondary",children:["This action cannot be canceled. To confirm, type ",e.jsx("b",{children:i})," in the box below."]})}),confirmValue:n.endpoint,confirmButtonText:"Delete",isLoading:r})},Ae=n=>{const a=A(),{network:o,setSelectedWebhookId:d}=T(),{data:l=[],isLoading:r}=q(o),[s,i]=h.useState(),[c,u]=h.useState();h.useEffect(()=>{if(c!==void 0){const t=setTimeout(()=>u(void 0),1500);return()=>clearTimeout(t)}},[c]);const j=h.useCallback(t=>{d(t.id),a(`./view?webhookId=${t.id}`)},[a,d]),y=h.useCallback(t=>{i({key:t,action:"delete"})},[]),f=h.useCallback(()=>{i(null)},[]);return r?e.jsx(P,{}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{border:"1px",borderColor:"background.contentTint",borderRadius:"sm",...n,children:e.jsxs(ne,{variant:"simple",children:[e.jsx(oe,{children:e.jsxs(M,{children:[e.jsx(m,{children:"ID"}),e.jsx(m,{children:"Webhook"}),e.jsx(m,{children:"Accounts"}),e.jsx(m,{children:"Opcodes"}),e.jsx(m,{children:"Mempool"}),e.jsx(m,{children:"New Contracts"}),e.jsx(m,{children:"Status"}),e.jsx(m,{children:"Token"})]})}),e.jsx(re,{children:l.map(t=>e.jsx(I,{as:ie,display:"contents",to:`./view?webhookId=${t.id}`,children:e.jsxs(M,{children:[e.jsx(b,{overflow:"hidden",maxW:"200px",children:e.jsx(O,{host:e.jsx(C,{layerStyle:"textEllipse",w:"fit-content",maxW:"100%",children:t.id}),offset:[-16,8],placement:"bottom-start",children:t.id})}),e.jsx(b,{overflow:"hidden",children:e.jsx(O,{host:e.jsx(C,{layerStyle:"textEllipse",w:"fit-content",maxW:"100%",children:t.endpoint}),offset:[-16,8],placement:"bottom-start",children:t.endpoint})}),e.jsx(b,{maxW:"70px",children:t.subscribed_accounts}),e.jsx(b,{maxW:"70px",children:t.subscribed_msg_opcodes}),e.jsx(b,{maxW:"70px",children:t.subscribed_to_mempool?"Yes":"No"}),e.jsx(b,{maxW:"70px",children:t.subscribed_to_new_contracts?"Yes":"No"}),e.jsx(b,{maxW:"100px",onClick:S=>S.preventDefault(),children:t.status===ae.RTOnline?"Online":"Offline"}),e.jsx(b,{w:"100px",children:e.jsxs(x,{align:"center",justify:"space-between",gap:"4",onClick:S=>S.preventDefault(),children:[e.jsxs(x,{align:"center",gap:"1",children:[e.jsx(N.span,{flexShrink:"1",w:"80px",layerStyle:"textEllipse",children:t.token}),c!==void 0&&c===t.id?e.jsx(E,{}):e.jsx(le,{"aria-label":"copy",icon:e.jsx(ce,{}),onClick:()=>{u(t.id),Ie(t.token)}})]}),e.jsxs(U,{placement:"bottom-end",children:[e.jsx(de,{icon:e.jsx(xe,{})}),e.jsxs(K,{w:"132px",children:[e.jsxs(W,{onClick:()=>j(t),children:[e.jsx(he,{mr:"2"}),e.jsx(p,{textStyle:"label2",fontFamily:"body",children:"View"})]}),e.jsxs(W,{onClick:()=>y(t),children:[e.jsx(Ee,{mr:"2"}),e.jsx(p,{textStyle:"label2",fontFamily:"body",children:"Delete"})]})]})]})]})})]})},t.id))})]})}),s&&e.jsx(Ne,{isOpen:(s==null?void 0:s.action)==="delete",webhook:s==null?void 0:s.key,onClose:f})]})},Le=({onOpenCreate:n})=>e.jsx(x,{align:"center",justify:"center",children:e.jsxs(x,{align:"center",direction:"column",maxW:"512px",children:[e.jsx(Oe,{mb:"8"}),e.jsx($,{mb:"2",children:"Your Webhooks will be shown here"}),e.jsx(p,{textStyle:"body2",mb:"6",color:"text.secondary",children:"Create your first Webhook"}),e.jsx(k,{onClick:n,children:"Create Webhook"})]})}),Be=()=>e.jsx(x,{align:"center",justify:"center",minH:"300px",children:e.jsx(x,{align:"center",direction:"column",maxW:"512px",children:e.jsxs(je,{alignItems:"center",justifyContent:"center",flexDir:"column",gap:"4",p:"8",textAlign:"center",bg:"background.contentTint",borderColor:"separator.common",borderRadius:"md",status:"info",variant:"subtle",children:[e.jsx(ue,{pt:"2",color:"text.primary",fontSize:"lg",fontWeight:"bold",children:"Webhooks playground is temporarily unavailable"}),e.jsx(me,{maxW:"512px",color:"text.secondary",fontSize:"sm",children:"The webhooks playground is not available at the moment. However, you can manage webhooks through the API."}),e.jsx(C,{mt:"4",children:e.jsx(I,{color:"accent.blue",fontWeight:"600",href:V.DOCUMENTATION_WEBHOOKS,isExternal:!0,children:"View Webhooks API Documentation"})})]})})}),F=({data:n,metricType:a,color:o})=>{const d=n.result.filter(r=>r.metric.type===a).flatMap(r=>r.values.map(([s,i])=>({time:s*1e3,value:parseFloat(i)}))),l=r=>{const s=new Date(r);return`${s.toLocaleDateString()} ${s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`};return e.jsx(be,{width:"100%",height:250,children:e.jsxs(pe,{data:d,children:[e.jsx(fe,{dataKey:"time",type:"number",domain:["auto","auto"],tickFormatter:l}),e.jsx(ye,{}),e.jsx(ke,{labelFormatter:r=>l(Number(r))}),e.jsx(ge,{dataKey:"value",fill:o})]})})},_e=({isOpen:n,onClose:a,data:o})=>o?e.jsxs(L,{isOpen:n,onClose:a,size:"4xl",children:[e.jsx(B,{}),e.jsxs(_,{children:[e.jsx(R,{children:"Webhook Statistics"}),e.jsx(z,{}),e.jsxs(H,{children:[e.jsx(p,{textStyle:"text.label1",mb:1,color:"text.secondary",fontSize:16,children:"Failed webhook requests"}),e.jsx(F,{data:o,metricType:"failed",color:"#F53C36"}),e.jsx(p,{textStyle:"text.label1",mb:1,color:"text.secondary",fontSize:16,children:"Delivered webhook requests"}),e.jsx(F,{data:o,metricType:"delivered",color:"#2E84E5"})]})]})]}):null,$e=()=>{const{isOpen:n,onOpen:a,onClose:o}=D(),{isOpen:d,onOpen:l,onClose:r}=D(),{network:s,setNetwork:i}=T(),{data:c=[],isLoading:u,error:j}=q(s),{data:y=null}=we();if(u)return e.jsx(Ce,{h:"300px",children:e.jsx(P,{})});if(j&&typeof j=="object"&&"status"in j&&j.status===501)return e.jsx(v,{h:"fit-content",children:e.jsx(Be,{})});if(j)return e.jsx(v,{h:"fit-content",children:e.jsx(x,{align:"center",justify:"center",minH:"300px",children:e.jsx(x,{align:"center",direction:"column",maxW:"512px",children:e.jsx(p,{textStyle:"body2",color:"text.secondary",textAlign:"center",children:"Unable to load webhooks at the moment. Please try refreshing the page."})})})});const f=c.length===0;return e.jsxs(e.Fragment,{children:[e.jsxs(v,{h:"fit-content",children:[e.jsxs(x,{mb:"3",children:[e.jsxs(x,{direction:"column",gap:2,children:[e.jsxs(x,{align:"center",gap:4,children:[e.jsx($,{children:"Webhooks"}),e.jsxs(U,{placement:"bottom",children:[e.jsx(We,{variant:"flat","aria-label":"network",rightIcon:e.jsx(Te,{}),textStyle:"label2",color:"text.secondary",children:e.jsx(w,{textTransform:"capitalize",children:s})}),e.jsxs(K,{w:"122px",children:[e.jsxs(W,{gap:"2",onClick:()=>i(g.MAINNET),children:[e.jsx(w,{textStyle:"label2",children:"Mainnet"}),s===g.MAINNET&&e.jsx(E,{})]}),e.jsxs(W,{gap:"2",onClick:()=>i(g.TESTNET),children:[e.jsx(w,{textStyle:"label2",children:"Testnet"}),s===g.TESTNET&&e.jsx(E,{})]})]})]})]}),e.jsx(x,{children:e.jsxs(p,{textStyle:"text.body2",color:"text.secondary",fontSize:14,children:["Webhooks are available via the API. For details, see"," ",e.jsx(I,{color:"accent.blue",href:V.DOCUMENTATION_WEBHOOKS,isExternal:!0,children:"Webhooks documentation"})]})})]}),!f&&e.jsx(k,{mb:"6",ml:"auto",onClick:a,children:"Add Webhook"})]}),f?e.jsx(Le,{onOpenCreate:a}):e.jsxs(e.Fragment,{children:[e.jsx(C,{mb:4,children:e.jsx(k,{onClick:l,variant:"secondary",children:"Statistics"})}),e.jsx(Ae,{})]})]}),e.jsx(Fe,{isOpen:n,onClose:o}),e.jsx(_e,{data:y,isOpen:d,onClose:r}),"  "]})};export{$e as default};
