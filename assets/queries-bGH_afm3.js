import{aT as o,s as u,aU as c,c3 as T,a3 as m,q as f,v as w,c4 as h,U as A,c5 as _,c6 as j}from"./index--6gyeIm1.js";function d(e){const t=e.instant_payment?e.usd_price*1e3:e.usd_price;return{id:e.id,name:e.name,price:new A(t),rps:e.rpc,type:e.instant_payment?"pay-as-you-go":"monthly"}}function p(e){if(!e)return null;const{id:t,name:r,rpc:n,usd_price:s,instant_payment:a,next_payment:i}=e,y=d({id:t,name:r,rpc:n,usd_price:s,instant_payment:a}),l=i&&s?new Date(i):void 0;return{...y,renewsDate:l,active:!0}}function C(){return o({queryKey:["rest-api-tiers"],queryFn:async()=>{const{data:e,error:t}=await _();if(t)throw t;return e.items.map(d)},staleTime:5*60*1e3})}function q(){const e=u();return o({queryKey:["selected-rest-api-tier",(e==null?void 0:e.id)||void 0],queryFn:async()=>{if(!e)return null;const{data:t,error:r}=await j({query:{project_id:e.id}});if(r)throw r;return p(t.tier)},enabled:!!e,staleTime:30*1e3})}function b(){return q()}function v(){const e=m(),t=f(),r=w();return c({mutationFn:async n=>{const s=t;if(!s)throw new Error("Project not selected");const{data:a,error:i}=await h({query:{project_id:s},body:{tier_id:n}});if(i)throw i;return{tier:p(a.tier),_projectId:s}},onSuccess:n=>{e.invalidateQueries({queryKey:["selected-rest-api-tier",n._projectId]}),r({title:"Successful purchase",status:"success",duration:3e3,isClosable:!0})},onError:()=>{r({title:"Unsuccessful purchase",status:"error",duration:3e3,isClosable:!0})}})}function I(){const e=u();return c({mutationFn:async t=>{const r=e==null?void 0:e.id;if(!r)throw new Error("Project not selected");const{data:n,error:s}=await T({path:{id:t},query:{project_id:r}});if(s)throw s;return n}})}export{q as a,v as b,C as c,I as d,b as u};
