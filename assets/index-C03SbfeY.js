import{y as Z,de as X,cM as Y,eB as Q,r as S,j as e,aK as F,aL as ee,b1 as C,bw as W,by as A,b3 as E,bB as te,bu as L,bz as z,cs as se,eC as re,a4 as _,a2 as $,T as k,ax as oe,b as D,du as ne,bt as ae,F as I,cv as ie,X as ce,q as le,ey as de,ez as ue,v as me,el as he,em as xe,a$ as pe,C as fe,V as be,O as je,B as ge,k as ye,eo as Se,D as ve,bH as Ce,b$ as R,N as M,bC as B,es as ke}from"./index--6gyeIm1.js";import{c as J}from"./create-icon-BJ8YnfLe.js";import{C as we}from"./card-Csp8xPXk.js";import{A as Ie}from"./airdrop.store-BCJp4K4U.js";import"./serialize-a49E7W4J.js";const K=Z(function(n,i){const t=X("Switch",n),{spacing:o="0.5rem",children:r,...h}=Y(n),{getIndicatorProps:j,getInputProps:u,getCheckboxProps:x,getRootProps:g,getLabelProps:y}=Q(h),w=S.useMemo(()=>({display:"inline-block",position:"relative",verticalAlign:"middle",lineHeight:0,...t.container}),[t.container]),f=S.useMemo(()=>({display:"inline-flex",flexShrink:0,justifyContent:"flex-start",boxSizing:"content-box",cursor:"pointer",...t.track}),[t.track]),v=S.useMemo(()=>({userSelect:"none",marginStart:o,...t.label}),[o,t.label]);return e.jsxs(F.label,{...g(),className:ee("chakra-switch",n.className),__css:w,children:[e.jsx("input",{className:"chakra-switch__input",...u({},i)}),e.jsx(F.span,{...x(),className:"chakra-switch__track",__css:f,children:e.jsx(F.span,{__css:t.thumb,className:"chakra-switch__thumb",...j()})}),r&&e.jsx(F.span,{className:"chakra-switch__label",...y(),__css:v,children:r})]})});K.displayName="Switch";const Te=J({d:"M0,12a1.5,1.5,0,0,0,1.5,1.5h8.75a.25.25,0,0,1,.25.25V22.5a1.5,1.5,0,0,0,3,0V13.75a.25.25,0,0,1,.25-.25H22.5a1.5,1.5,0,0,0,0-3H13.75a.25.25,0,0,1-.25-.25V1.5a1.5,1.5,0,0,0-3,0v8.75a.25.25,0,0,1-.25.25H1.5A1.5,1.5,0,0,0,0,12Z",displayName:"AddIcon"}),Ne=J({displayName:"DeleteIcon",path:e.jsx("g",{fill:"currentColor",children:e.jsx("path",{d:"M19.452 7.5H4.547a.5.5 0 00-.5.545l1.287 14.136A2 2 0 007.326 24h9.347a2 2 0 001.992-1.819L19.95 8.045a.5.5 0 00-.129-.382.5.5 0 00-.369-.163zm-9.2 13a.75.75 0 01-1.5 0v-9a.75.75 0 011.5 0zm5 0a.75.75 0 01-1.5 0v-9a.75.75 0 011.5 0zM22 4h-4.75a.25.25 0 01-.25-.25V2.5A2.5 2.5 0 0014.5 0h-5A2.5 2.5 0 007 2.5v1.25a.25.25 0 01-.25.25H2a1 1 0 000 2h20a1 1 0 000-2zM9 3.75V2.5a.5.5 0 01.5-.5h5a.5.5 0 01.5.5v1.25a.25.25 0 01-.25.25h-5.5A.25.25 0 019 3.75z"})})}),q="name",Fe=({context:{register:s,formState:{errors:n,isSubmitted:i}}})=>{const t=q,o=n[q],r=i&&!!o;return e.jsxs(C,{mb:0,isInvalid:r,isRequired:!0,children:[e.jsx(W,{htmlFor:t,children:"Name"}),e.jsx(A,{autoComplete:"off",autoFocus:!0,id:t,placeholder:"Airdrop Name",...s(t,{required:"This is required"})}),e.jsx(E,{pos:"static",children:o&&o.message})]})},V="address",Ae=({context:{register:s,formState:{errors:n,isSubmitted:i}}})=>{const t=V,o=n[V],r=i&&!!o;return e.jsxs(C,{mb:0,isInvalid:r,isRequired:!0,children:[e.jsx(W,{htmlFor:t,children:"Jetton address"}),e.jsx(A,{autoComplete:"off",id:t,placeholder:"Address of the distributed token",...s(t,{required:"This is required",validate:h=>{if(!te(h,{acceptTestnet:!0,acceptRaw:!0}))return"Wrong address"}})}),e.jsx(E,{pos:"static",children:o&&o.message})]})},H="fee",Ee=({context:{register:s,formState:{errors:n,isSubmitted:i}}})=>{const t=H,o=n[H],r=i&&!!o,{ref:h}=L({mask:Number,scale:2,radix:"."}),{ref:j,...u}=s(t,{required:"This is required",validate:x=>{if(parseFloat(x)<.15)return"Minimum 0.15 TON";if(parseFloat(x)>5)return"Maximum 5 TON"}});return e.jsxs(C,{mb:0,isInvalid:r,isRequired:!0,children:[e.jsx(W,{htmlFor:t,children:"Claim Fee"}),e.jsx(A,{ref:z(h,j),autoComplete:"off",defaultValue:"0.15",id:t,placeholder:"0.15 TON",...u}),e.jsx(E,{pos:"static",children:o&&o.message}),e.jsx(se,{textStyle:"body2",color:"text.secondary",children:"Amount of TON required to receive Jettons. Min: 0.15 TON and Max: 5 TON."})]})},O=(s=new Date)=>{const n=s.getFullYear(),i=String(s.getMonth()+1).padStart(2,"0"),t=String(s.getDate()).padStart(2,"0"),o=String(s.getHours()).padStart(2,"0"),r=String(s.getMinutes()).padStart(2,"0");return`${n}-${i}-${t}T${o}:${r}`},N="vesting",_e=({hookFractionRef:s,registerFractionRest:n})=>{const{ref:i}=L({mask:Number,scale:2,radix:"."});return e.jsx(A,{ref:z(i,s),autoComplete:"off",placeholder:"Fraction",...n})},De=({context:{register:s,formState:{errors:n,isSubmitted:i},control:t,watch:o}})=>{const[r,h]=S.useState(!1),j=n[N],u=o(N)||[],x=i,{fields:g,append:y,remove:w}=re({control:t,name:N}),f=(d,a)=>{if(!a)return!1;const m=new Date(a);if(m<new Date)return!1;if(d===0)return!0;const c=u[d-1].unlockTime,b=c?new Date(c):void 0;return b?m>b:!0},v=(d,a)=>{const m=u.reduce((c,b,T)=>T===d?c+a:c+(Number(b.fraction)||0),0),l=u.some(c=>Number(c.fraction||0)<=0);return m===100&&!l},p=()=>{const d=u.some((l,c)=>!f(c,l==null?void 0:l.unlockTime)),a=u.some((l,c)=>!v(c,Number(l==null?void 0:l.fraction))),m=u.some(l=>Number(l.fraction||0)<=0);return d&&a?"date-fraction":d?"date":m?"zero":a?"fraction":"valid"};return e.jsxs(e.Fragment,{children:[e.jsx(K,{textStyle:"label2",alignItems:"center",alignSelf:"flex-start",display:"flex",isChecked:r,onChange:d=>{h(d.target.checked),d.target.checked?y([{},{}]):w()},children:"Enable Vesting"}),r&&e.jsx(C,{mb:0,isInvalid:x&&!!j,isRequired:!0,children:e.jsxs(_,{alignItems:"stretch",spacing:2,children:[e.jsxs($,{spacing:4,children:[e.jsx(k,{textStyle:"label2",w:213,children:"Unlock Date"}),e.jsx(k,{textStyle:"label2",w:213,children:"Percent"})]}),e.jsxs(_,{align:"stretch",spacing:4,children:[g.map((d,a)=>{var m,l;return e.jsx(_,{align:"stretch",children:e.jsxs($,{spacing:4,children:[e.jsx(C,{mb:0,isInvalid:x&&!f(a,(m=u[a])==null?void 0:m.unlockTime),children:e.jsx(A,{max:O(new Date(Date.now()+1e3*60*60*24*365*5)),min:O(),type:"datetime-local",...s(`${N}.${a}.unlockTime`,{required:"Time is required",validate:c=>f(a,c)})})}),e.jsx(C,{mb:0,isInvalid:x&&!v(a,Number((l=u[a])==null?void 0:l.fraction)),children:(()=>{const{ref:c,...b}=s(`${N}.${a}.fraction`,{required:"Fraction is required",validate:T=>v(a,Number(T))});return e.jsx(_e,{hookFractionRef:c,registerFractionRest:b})})()}),e.jsx(oe,{w:"44px",minW:"44px",maxW:"44px","aria-label":"Remove vesting period",icon:e.jsx(Ne,{}),isDisabled:g.length===1,onClick:()=>w(a),variant:"secondary"})]})},d.id)}),x&&p()!=="valid"&&e.jsx(C,{mb:0,isInvalid:p()!=="valid",children:e.jsxs(E,{pos:"static",children:[p()==="date-fraction"&&"New date must be later than the previous one and date must be no earlier than tomorrow and percentages must sum up to 100",p()==="zero"&&"Percentage value must be greater than zero.",p()==="date"&&"New date must be later than the previous one and date must be no earlier than tomorrow",p()==="fraction"&&"Percentages must sum up to 100"]})}),e.jsx(D,{alignSelf:"flex-start",leftIcon:e.jsx(Te,{}),onClick:()=>y({}),variant:"secondary",children:"Add unlock date"})]})]})})]})},We=ne(({id:s,onSubmit:n,...i})=>{const t=ae(),{handleSubmit:o}=t,r=h=>{n(h)};return e.jsxs(F.form,{id:s,w:"100%",onSubmit:o(r),noValidate:!0,gap:4,display:"flex",flexDirection:"column",...i,children:[e.jsx(Fe,{context:t}),e.jsx(Ae,{context:t}),e.jsx(Ee,{context:t}),e.jsx(De,{context:t})]})}),$e=()=>e.jsx(we,{bg:"background.contentTint",children:e.jsx(I,{direction:"column",gap:"6px",p:"16px",children:e.jsxs(I,{align:"flex-start",justify:"space-between",direction:"row",children:[e.jsx(k,{textStyle:"body2",color:"text.secondary",children:"Wallet connection is done through TON Connect. Only wallet version W5 is supported. The address of the connected wallet will be considered the administrator's address, and all subsequent actions will be available only from it."}),e.jsx(ie,{})]})})}),Re=s=>ke.jettons.getJettonInfo(B.Address.parse(s)).then(()=>!0,()=>!1),P=s=>B.Cell.fromBase64(s).refs[0].hash().toString("base64")==="IINLe3KxEhR+Gy+0V7hOdNGjDwT3N9T2KmaOlVLSty8=",ze=({airdropsStore:s,...n})=>{const i=ce(),t=le(),o=de(),r=ue(),h=me(),j=he(),{open:u}=xe(),[x,g]=S.useState(!1),[y,w]=S.useState(!1),[f,v]=S.useState(!1),p=s.config$.value,d=pe({mode:"onSubmit"}),a="airdrops-form-id",m=()=>{h({title:"Connect wallet W5",description:"Please reconnect with wallet W5",position:"bottom-left",duration:5e3,status:"error",isClosable:!0})};S.useEffect(()=>{o&&(r!=null&&r.account.walletStateInit)&&(P(r==null?void 0:r.account.walletStateInit)||m())},[r,o]);const l=async({name:c,address:b,fee:T,vesting:U})=>{if(!P((r==null?void 0:r.account.walletStateInit)||"")){m();return}if(g(!0),!await Re(b)){d.setError("address",{message:"Jetton not found"}),g(!1);return}const G=await new Ie({projectId:t,airdrops:s.airdrops$.value}).createAirdrop({name:c,address:b,fee:T,vesting:U,adminAddress:j});g(!1),i(`/jetton/airdrops/${G}`)};return!s.config$.isResolved||!p?e.jsx(fe,{h:"300px",children:e.jsx(be,{})}):e.jsxs(je,{display:"flex",flexDirection:"column",px:"0",...n,children:[e.jsxs(I,{align:"flex-start",justify:"space-between",mb:"5",px:"6",children:[e.jsxs(ge,{children:[e.jsx(I,{align:"center",direction:"row",gap:"8px",children:e.jsx(ye,{mb:"1",children:"New Airdrop"})}),e.jsx(k,{textStyle:"body2",color:"text.secondary",children:"Fill in the details and connect your wallet"})]}),e.jsx(Se,{})]}),e.jsx(ve,{mb:"3"}),e.jsxs(I,{align:"flex-start",direction:"column",gap:"24px",maxW:"550px",px:"6",children:[e.jsxs(I,{align:"flex-start",direction:"column",gap:"12px",children:[e.jsxs(Ce,{...d,children:[e.jsx(We,{onSubmit:l,id:a}),e.jsxs(k,{textStyle:"label2",color:"text.secondary",children:["Royalty coefficient:"," ",p.royalty_numerator/p.royalty_denominator," (see it in Airdop T&C Terms)"]})]}),e.jsx(R,{checked:y,onChange:()=>w(!y),children:e.jsxs(k,{textStyle:"label2",color:"text.secondary",children:["I have read and agree with the"," ",e.jsx(M,{textStyle:"label2",color:"accent.blue",href:"https://docs.tonconsole.com/tonconsole/jettons/airdrop/terms",isExternal:!0,children:"Airdrop Terms of Use"})]})}),e.jsx(R,{checked:f,onChange:()=>v(!f),children:e.jsxs(k,{textStyle:"label2",color:"text.secondary",children:["I have read and agree with the"," ",e.jsx(M,{textStyle:"label2",color:"accent.blue",href:"https://docs.tonconsole.com/tonconsole/jettons/airdrop",isExternal:!0,children:"Airdop T&C Terms"})]})}),j?e.jsx(D,{flex:1,maxW:600,mt:4,form:a,isDisabled:!y||!f,isLoading:x,type:"submit",variant:"primary",children:"Continue"}):e.jsx(D,{flex:1,maxW:600,mt:4,onClick:u,variant:"primary",children:"Connect W5 Wallet"})]}),e.jsx($e,{})]})]})};export{ze as default};
