import{j as e,F as f,a4 as de,T as m,a5 as xe,Y as W,r as b,a6 as he,a7 as ue,a8 as me,a9 as je,aa as be,ab as A,ac as pe,ad as ye,ae as U,af as fe,ag as ge,ah as ve,ai as Le,aj as Se,ak as we,al as Ce,am as De,an as J,ao as Q,M as Ae,B as p,ap as Oe,aq as ke,ar as Pe,as as $,at as Ee,au as Re,av as Ie,aw as Fe,ax as O,C as g,V as H,ay as Me,az as We,aA as Te,aB as He,aC as Ne,aD as qe,aE as N,l as q,a2 as se,aF as ze,b as Be,O as Ge,k as _e,N as Ke,E as Xe,c as Ve,aG as Ye,aH as Ue,D as Je,aI as Z,aJ as M}from"./index--6gyeIm1.js";import{u as ne,a as ae}from"./queries-Bk5JuKYX.js";import{a as z}from"./queries-bGH_afm3.js";import{c as Qe}from"./create-icon-BJ8YnfLe.js";import{a as R}from"./queries-Dkadx4GS.js";import{u as ie,m as P}from"./queries-CpxNtx4N.js";import{C as $e}from"./card-Csp8xPXk.js";import{C as Ze}from"./card-header-Bk90WjMF.js";import{C as et}from"./card-body-B5KnP0ef.js";import{L as tt,a as rt,b as st}from"./list-DJsRQ8jn.js";import{F as nt}from"./FeaturesList-BBerE3Rj.js";import{g as at}from"./time-periods-B2gFC1G6.js";const k=Qe({d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z",displayName:"ChevronUpIcon"}),ee=({tier:t,service:r,...n})=>{const a=(l=>l?typeof l=="number"?W(new Date(l*1e3)):W(l):null)(t==null?void 0:t.renewsDate);return e.jsxs($e,{flex:"1",minW:"250px",maxW:"350px",...n,children:[e.jsx(Ze,{p:"4",children:e.jsxs(f,{align:"flex-start",justify:"space-between",gap:"2",w:"100%",children:[e.jsxs(de,{align:"flex-start",spacing:"1",children:[r&&e.jsx(m,{textStyle:"body3",color:"text.secondary",children:r}),e.jsx(m,{textStyle:"label1",color:"text.primary",children:(t==null?void 0:t.name)||"Free"})]}),a&&e.jsxs(m,{textStyle:"body3",color:"text.secondary",whiteSpace:"nowrap",children:["Available until ",a]})]})}),e.jsx(et,{children:e.jsx(tt,{flex:"1",spacing:"2",children:e.jsxs(rt,{display:"flex",children:[e.jsx(st,{as:xe,color:"text.primary"}),e.jsxs(m,{textStyle:"body2",color:"text.primary",children:[t.rps," requests per second"]})]})})})]})};function te(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);r&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,s)}return n}function re(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?te(Object(n),!0).forEach(function(s){B(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function B(t,r,n){return(r=it(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function it(t){var r=lt(t,"string");return typeof r=="symbol"?r:r+""}function lt(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,r);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function T(){return T=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},T.apply(null,arguments)}var ot=(t,r)=>{var n;return b.isValidElement(t)?n=b.cloneElement(t,r):typeof t=="function"?n=t(r):n=b.createElement("line",T({},r,{className:"recharts-reference-line-line"})),n},ct=(t,r,n,s,a,l,c,o,d)=>{var{x:u,y:h,width:i,height:x}=a;if(n){var{y:j}=d,y=t.y.apply(j,{position:l});if(J(y)||d.ifOverflow==="discard"&&!t.y.isInRange(y))return null;var w=[{x:u+i,y},{x:u,y}];return o==="left"?w.reverse():w}if(r){var{x:I}=d,L=t.x.apply(I,{position:l});if(J(L)||d.ifOverflow==="discard"&&!t.x.isInRange(L))return null;var D=[{x:L,y:h+x},{x:L,y:h}];return c==="top"?D.reverse():D}if(s){var{segment:F}=d,C=F.map(S=>t.apply(S,{position:l}));return d.ifOverflow==="discard"&&C.some(S=>!t.isInRange(S))?null:C}return null};function dt(t){var r=he();return b.useEffect(()=>(r(ue(t)),()=>{r(me(t))})),null}function xt(t){var{x:r,y:n,segment:s,xAxisId:a,yAxisId:l,shape:c,className:o,ifOverflow:d}=t,u=je(),h=be(),i=A(v=>pe(v,a)),x=A(v=>ye(v,l)),j=A(v=>U(v,"xAxis",a,u)),y=A(v=>U(v,"yAxis",l,u)),w=fe(),I=Q(r),L=Q(n);if(!h||!w||i==null||x==null||j==null||y==null)return null;var D=ge({x:j,y}),F=s&&s.length===2,C=ct(D,I,L,F,w,t.position,i.orientation,x.orientation,t);if(!C)return null;var[{x:S,y:X},{x:V,y:Y}]=C,oe=d==="hidden"?"url(#".concat(h,")"):void 0,ce=re(re({clipPath:oe},ve(t)),{},{x1:S,y1:X,x2:V,y2:Y});return b.createElement(Le,{className:Se("recharts-reference-line",o)},ot(c,ce),b.createElement(we,Ce({x1:S,y1:X,x2:V,y2:Y}),b.createElement(De,{label:t.label}),t.children))}function ht(t){return b.createElement(b.Fragment,null,b.createElement(dt,{yAxisId:t.yAxisId,xAxisId:t.xAxisId,ifOverflow:t.ifOverflow,x:t.x,y:t.y}),b.createElement(xt,t))}class G extends b.Component{render(){return b.createElement(ht,this.props)}}B(G,"displayName","ReferenceLine");B(G,"defaultProps",{ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});const _=({data:t,title:r,color:n,limit:s,limitLabel:a="Limit",height:l=250,...c})=>{const o=b.useMemo(()=>{if(!(t!=null&&t.length))return[];const i=t.filter((x,j)=>j%48===0).map(x=>x.time);return i.includes(t[t.length-1].time)||i.push(t[t.length-1].time),i},[t]),d=b.useCallback(i=>Ae(new Date(i)),[]),u=b.useCallback(i=>W(new Date(i)),[]),h=b.useMemo(()=>{if(!(t!=null&&t.length)||!s)return!1;const i=t.map(x=>x.value);return Math.max(...i)>=s*.67},[t,s]);return e.jsx(p,{h:`${l}px`,...c,sx:{".recharts-wrapper .recharts-cartesian-grid-horizontal line:last-child":{strokeOpacity:0}},children:e.jsx(Oe,{width:"99%",height:"100%",children:e.jsxs(ke,{width:400,height:l,data:t,margin:{top:10,right:0,bottom:0,left:0},children:[e.jsx(Pe,{strokeDasharray:"3 3"}),e.jsx($,{dot:!1,type:"monotone",dataKey:"value",name:r,stroke:n,isAnimationActive:!1}),h&&s&&e.jsxs(e.Fragment,{children:[e.jsx(G,{ifOverflow:"extendDomain",y:s,stroke:"#F53C36"}),e.jsx($,{dot:!1,dataKey:"ReferenceLineStub",name:a,stroke:"#F53C36"})]}),e.jsx(Ee,{dataKey:"time",domain:["dataMin","dataMax"],tickFormatter:u,name:"time",type:"number",ticks:o.length>0?o:void 0}),e.jsx(Re,{padding:{top:10,bottom:0}}),e.jsx(Ie,{labelFormatter:d}),e.jsx(Fe,{})]})})})},ut=({title:t,data:r,isLoading:n,error:s,color:a,limit:l,limitLabel:c,onExpand:o,compact:d=!1,...u})=>{const h=d?"120px":"200px",i=d?"150px":"200px";return n?e.jsxs(p,{p:"4",borderWidth:"1px",borderColor:"border.primary",borderRadius:"12px",...u,children:[e.jsxs(f,{align:"center",justify:"space-between",mb:"4",children:[e.jsx(m,{textStyle:"label1",color:"text.primary",children:t}),o&&(r==null?void 0:r.length)&&e.jsx(O,{"aria-label":"Expand chart",icon:e.jsx(k,{}),onClick:o,size:"sm",variant:"ghost"})]}),e.jsx(g,{h,children:e.jsx(H,{})})]}):s?e.jsxs(p,{p:"4",borderWidth:"1px",borderColor:"border.primary",borderRadius:"12px",...u,children:[e.jsxs(f,{align:"center",justify:"space-between",mb:"4",children:[e.jsx(m,{textStyle:"label1",color:"text.primary",children:t}),o&&(r==null?void 0:r.length)&&e.jsx(O,{"aria-label":"Expand chart",icon:e.jsx(k,{}),onClick:o,size:"sm",variant:"ghost"})]}),e.jsx(g,{h,children:e.jsx(m,{textStyle:"body2",color:"text.secondary",children:"Error loading data"})})]}):r!=null&&r.length?e.jsxs(p,{p:"4",borderWidth:"1px",borderColor:"border.primary",borderRadius:"12px",...u,children:[e.jsxs(f,{align:"center",justify:"space-between",mb:"4",children:[e.jsx(m,{textStyle:"label1",color:"text.primary",children:t}),o&&e.jsx(O,{"aria-label":"Expand chart",icon:e.jsx(k,{}),onClick:o,size:"sm",variant:"ghost"})]}),e.jsx(_,{data:r,title:t,color:a,limit:l,limitLabel:c,height:parseInt(i)})]}):e.jsxs(p,{p:"4",borderWidth:"1px",borderColor:"border.primary",borderRadius:"12px",...u,children:[e.jsx(f,{align:"center",justify:"space-between",mb:"4",children:e.jsx(m,{textStyle:"label1",color:"text.primary",children:t})}),e.jsx(g,{h,children:e.jsx(m,{textStyle:"body2",color:"text.secondary",children:"Empty data"})})]})},K=({isOpen:t,onClose:r,title:n,charts:s})=>e.jsxs(Me,{isOpen:t,onClose:r,size:"4xl",children:[e.jsx(We,{}),e.jsxs(Te,{children:[e.jsx(He,{children:n}),e.jsx(Ne,{}),e.jsx(qe,{pb:4,children:e.jsx(f,{direction:"column",gap:8,children:s.map((a,l)=>e.jsxs(p,{children:[e.jsx(m,{textStyle:"label1",mb:4,color:"text.secondary",fontSize:16,children:a.title}),e.jsx(p,{h:300,children:e.jsx(_,{data:a.data,title:a.title,color:a.color,limit:a.limit,limitLabel:a.limitLabel,height:300})})]},l))})})]})]}),mt=({period:t,...r})=>{const{colors:n}=N(),{data:s,isLoading:a,error:l}=ne(t),{data:c,isLoading:o}=z(),{isOpen:d,onOpen:u,onClose:h}=q(),i=a||o;return e.jsxs(e.Fragment,{children:[e.jsx(ut,{title:"REST API requests on behalf",data:s||null,isLoading:i,error:l,color:n.accent.blue,limit:c==null?void 0:c.rps,limitLabel:"Limit",onExpand:u,...r}),e.jsx(K,{isOpen:d,onClose:h,title:"REST API Statistics",charts:s&&s.length>0?[{title:"AVG req. per second",data:s,color:n.accent.blue,limit:c==null?void 0:c.rps,limitLabel:"Limit"}]:[]})]})},le=({title:t,onExpand:r,children:n,hasData:s,childrenDirection:a="column",...l})=>e.jsxs(p,{p:"4",borderWidth:"1px",borderColor:"border.primary",borderRadius:"12px",...l,children:[e.jsxs(f,{align:"center",justify:"space-between",mb:"4",children:[e.jsx(m,{textStyle:"label1",color:"text.primary",fontSize:16,children:t}),r&&s&&e.jsx(O,{"aria-label":"Expand",icon:e.jsx(k,{}),onClick:r,size:"sm",variant:"ghost"})]}),e.jsx(f,{direction:a,gap:"4",children:n})]}),E=({title:t,data:r,isLoading:n,error:s,color:a,limit:l,limitLabel:c,compact:o=!1,...d})=>{const u=o?"120px":"200px",h=o?"150px":"200px";return n?e.jsxs(p,{w:"100%",...d,children:[e.jsx(m,{textStyle:"body2",mb:"2",color:"text.secondary",children:t}),e.jsx(g,{h:u,children:e.jsx(H,{})})]}):s?e.jsxs(p,{w:"100%",...d,children:[e.jsx(m,{textStyle:"body2",mb:"2",color:"text.secondary",children:t}),e.jsx(g,{h:u,children:e.jsx(m,{textStyle:"body2",color:"text.error",children:"Error loading data"})})]}):!r||r.length===0?e.jsxs(p,{w:"100%",...d,children:[e.jsx(m,{textStyle:"body2",mb:"2",color:"text.secondary",children:t}),e.jsx(g,{h:u,children:e.jsx(m,{textStyle:"body2",color:"text.secondary",children:"Empty data"})})]}):e.jsxs(p,{w:"100%",...d,children:[e.jsx(m,{textStyle:"body2",mb:"2",color:"text.secondary",children:t}),e.jsx(p,{w:"100%",h,children:e.jsx(_,{data:r,title:t,color:a,limit:l,limitLabel:c,height:o?150:200})})]})},jt=({period:t,childrenDirection:r,...n})=>{const{colors:s}=N(),{data:a,isLoading:l,error:c}=ae(t),{data:o}=R(),{isOpen:d,onOpen:u,onClose:h}=q(),i=(a==null?void 0:a.requests)||null,x=(a==null?void 0:a.connections)||null,j=!!(i&&i.length>0&&x&&x.length>0),y=!!o;return!y&&!j?null:!y&&j?e.jsx(g,{flexDir:"column",gap:"4",minH:"200px",borderWidth:"1px",borderRadius:"12px",...n,children:e.jsx(m,{color:"text.secondary",children:"Liteservers service is not activated"})}):e.jsxs(e.Fragment,{children:[e.jsxs(le,{title:"Liteservers Statistics",onExpand:u,hasData:j,childrenDirection:r,...n,children:[e.jsx(E,{title:"Requests",data:i,isLoading:l,error:c,color:s.accent.blue,compact:!j,limit:o==null?void 0:o.rps,limitLabel:"Limit"}),e.jsx(E,{title:"Connections",data:x,isLoading:l,error:c,color:s.accent.green,compact:!j})]}),e.jsx(K,{isOpen:d,onClose:h,title:"Liteservers Statistics",charts:[{title:"Liteservers Requests",data:i||[],color:s.accent.blue,limit:o==null?void 0:o.rps,limitLabel:"Limit"},{title:"Liteservers Connections",data:x||[],color:s.accent.green}]})]})},bt=({period:t,childrenDirection:r,...n})=>{const{colors:s}=N(),{data:a,isLoading:l,error:c}=ie(t),{data:o}=R(),{isOpen:d,onOpen:u,onClose:h}=q(),i=a?P(a,"failed"):null,x=a?P(a,"delivered"):null,j=i&&i.length>0||x&&x.length>0,y=!!o;return j?!y&&j?e.jsx(g,{flexDir:"column",gap:"4",minH:"200px",borderWidth:"1px",borderRadius:"12px",...n,children:e.jsx(m,{color:"text.secondary",children:"Webhooks service is not activated"})}):e.jsxs(e.Fragment,{children:[e.jsxs(le,{title:"Webhook",onExpand:u,hasData:j,childrenDirection:r,...n,children:[e.jsx(E,{title:"Delivered",data:x&&x.length>0?x:null,isLoading:l,error:c,color:s.accent.blue,compact:!j}),e.jsx(E,{title:"Failed",data:i&&i.length>0?i:null,isLoading:l,error:c,color:s.accent.red,compact:!j})]}),e.jsx(K,{isOpen:d,onClose:h,title:"Webhook",charts:[{title:"Failed webhook requests",data:i&&i.length>0?i:[],color:s.accent.red},{title:"Delivered webhook requests",data:x&&x.length>0?x:[],color:s.accent.blue}]})]}):null},pt=t=>{const{data:r,isLoading:n}=z(),{data:s,isLoading:a}=R();return n||a?e.jsx(g,{h:"78px",...t,children:e.jsx(H,{})}):e.jsxs(f,{wrap:"wrap",gap:"4",...t,children:[r&&e.jsx(ee,{tier:r,service:"REST API"}),s&&e.jsx(ee,{tier:{name:s.name,rps:s.rps,renewsDate:s.next_payment},service:"Liteservers"})]})},yt=({value:t,onChange:r})=>{const n=at();return e.jsx(se,{spacing:"2",children:e.jsx(ze,{isAttached:!0,size:"sm",variant:"outline",children:n.map(s=>e.jsx(Be,{isActive:t===s.value,onClick:()=>r(s.value),children:s.label},s.value))})})},Et=()=>{const[t,r]=b.useState("last_6h"),{data:n}=z(),{data:s}=R(),{data:a}=ne(t),{data:l}=ae(t),{data:c}=ie(t),o=b.useMemo(()=>a&&a.length>0,[a]),d=b.useMemo(()=>(l==null?void 0:l.requests)&&l.requests.length>0,[l]),u=b.useMemo(()=>{if(!c)return!1;const x=P(c,"failed"),j=P(c,"delivered");return x&&x.length>0||j&&j.length>0},[c]),h=s||d,i=u;return e.jsxs(e.Fragment,{children:[e.jsxs(Ge,{h:"fit-content",mb:"4",children:[e.jsxs(f,{align:"center",justify:"space-between",mb:"4",children:[e.jsx(_e,{children:"Dashboard"}),e.jsx(Ke,{_hover:{textDecoration:"none",opacity:.8},href:Xe.TG_CHANNEL,isExternal:!0,children:e.jsxs(se,{color:"text.secondary",spacing:"2",children:[e.jsx(Ve,{}),e.jsx(Ye,{below:"md",children:e.jsx(m,{textStyle:"body2",children:"Telegram Channel"})})]})})]}),e.jsx(pt,{mb:{base:4,md:6}}),(o||n)&&e.jsx(Ue,{below:"md",children:e.jsx(Je,{mb:"4"})}),(o||n)&&e.jsxs(e.Fragment,{children:[e.jsxs(f,{align:"center",justify:"space-between",wrap:"wrap",gap:"2",mb:"5",children:[e.jsx(m,{textStyle:"label1",color:"text.primary",children:"Statistics"}),e.jsx(yt,{value:t,onChange:r})]}),e.jsxs(Z,{gap:"4",mb:"6",children:[e.jsx(M,{colSpan:{base:1,lg:1},children:e.jsx(mt,{period:t})}),(h||i)&&e.jsxs(Z,{gap:"4",templateColumns:{base:"1fr",lg:h&&i?"repeat(2, 1fr)":"1fr"},w:"100%",children:[h&&e.jsx(M,{children:e.jsx(jt,{period:t,childrenDirection:h&&i?"column":"row"})}),i&&e.jsx(M,{children:e.jsx(bt,{period:t,childrenDirection:h&&i?"column":"row"})})]})]})]})]}),e.jsx(nt,{isContrast:!0})]})};export{Et as default};
