import{an as i,bP as o,ao as u,bQ as y,Z as l,W as m,aZ as T,bR as f,bS as w,bT as h}from"./index-BCN26Ft_.js";import{U as c}from"./usd-currency-amount-OKdR9Ymz.js";function j(e){return{id:e.id,name:e.name,price:new c(e.usd_price),rps:e.rpc,type:e.instant_payment?"pay-as-you-go":"monthly"}}function d(e){if(!e)return null;const t=e.next_payment,r=e.usd_price,n=t&&r?new Date(t):void 0;return{id:e.id,name:e.name,price:new c(r),rps:e.rpc,type:e.instant_payment?"pay-as-you-go":"monthly",renewsDate:n,active:!0}}function _(){return i({queryKey:["rest-api-tiers"],queryFn:async()=>{const{data:e,error:t}=await w();if(t)throw t;return e.items.map(j)},staleTime:5*60*1e3})}function A(){const e=o();return i({queryKey:["selected-rest-api-tier",(e==null?void 0:e.id)||void 0],queryFn:async()=>{if(!e)return null;const{data:t,error:r}=await h({query:{project_id:e.id}});if(r)throw r;return d(t.tier)},enabled:!!e,staleTime:30*1e3})}function q(){return A()}function C(){const e=l(),t=m(),r=T();return u({mutationFn:async n=>{const s=t;if(!s)throw new Error("Project not selected");const{data:p,error:a}=await f({query:{project_id:s},body:{tier_id:n}});if(a)throw a;return{tier:d(p.tier),_projectId:s}},onSuccess:n=>{e.invalidateQueries({queryKey:["selected-rest-api-tier",n._projectId]}),r({title:"Successful purchase",status:"success",duration:3e3,isClosable:!0})},onError:()=>{r({title:"Unsuccessful purchase",status:"error",duration:3e3,isClosable:!0})}})}function R(){const e=o();return u({mutationFn:async t=>{const r=e==null?void 0:e.id;if(!r)throw new Error("Project not selected");const{data:n,error:s}=await y({path:{id:t},query:{project_id:r}});if(s)throw s;return n}})}export{A as a,C as b,_ as c,R as d,q as u};
